{% extends 'base.html' %}

{% block header %}
  <!-- <h2>{% block title %}{% endblock %}</h2> -->
  <!-- {% if g.user %}
    <a class="action" href="{{ url_for('question.create') }}">New</a>
  {% endif %} -->
  {% endblock %}
{%block content%}
  <br>
    <article class="post">
        <!-- <h2><b class="blog-header">{{posts['title']}}</b></h2> -->
        <h2><b class="blog-header">{{posts['title']}}</b></h2>
        <p class="blog-post-title" >{{posts['body']}}</p>
        <div class="form-row blog-description">
        {% for ta in tags %}
        {{ ta[0]+ " " }}
       {% endfor %}
        </div>
       <div class="profile-pic" style="text-align: right" >
          <a href="{{ url_for('auth.profile',id=posts['author_id']) }}" ><img width="30px" height="30px" class="image-fluid" src="{{ url_for('static', filename=posts['profile_picture'])}}"></a>
       <p class="about blog-description" style="text-align: right">by {{ posts['username'] }} on {{ posts['created']}}</p>
       </div>
       <p class="blog-post-meta" style="text-align: right">{{posts['upvotes']}} Upvotes</p>
     <div style="text-align: right">
      <a class="action" href="{{ url_for('question.upvote_question', id=posts['qid']) }}"><i class="fas fa-angle-up text-dark">Upvote</i></a>
      <a class="action" href="{{ url_for('question.downvote_question', id=posts['qid']) }}"><i class="fas fa-angle-down text-dark">Downvote</i></p>
      </div>
    </article>     
    <p style="text-align: right"><a class="action text-dark" href="{{ url_for('question.create_comment', id=posts['qid']) }}">Add comment</a></p>

     <br>
        {% for comm in comments %}
        <p style="text-align:right;margin-left:5%; font-style: italic;"><span >{{ comm[3] }}</span></p>
       {% endfor %}
       <p class="blog-post-meta"> {{ans_len}} answers </p>       
    <hr> 
    {% for ans in ans %}
    <article class="ans">
      <header>
        <div>
          <p class="blog-post-title">{{ ans['body'] }}</p>

          <div class="about">
              <div class="profile-pic" style="text-align: right" >
                  <a href="{{ url_for('auth.profile',id=ans['author_id']) }}" ><img width="30px" height="30px" class="image-fluid" src="{{ url_for('static', filename=ans['profile_picture'])}}"></a>
            <p class="about blog-description" style="text-align: right">by {{ ans['username'] }} on {{ ans['created']}}</p>
              </div>
            <p class="blog-post-meta" style="text-align: right">{{ans['upvotes']}} Upvotes</p>
            <div style="text-align: right">
            {% if g.user['id'] == ans['author_id'] %}
              <a class="action" href="{{ url_for('question.updateanswer', id=ans['id']) }}" style="text-align: right"><i class="far fa-edit text-dark">Edit</i></a>
            {% endif %}
            <a class="action" href="{{ url_for('question.upvote_answer', id=ans['id']) }}"><i class="fas fa-angle-up text-dark">Upvote</i></a>
            <a class="action" href="{{ url_for('question.downvote_answer', id=ans['id']) }}"><i class="fas fa-angle-down text-dark">Downvote</i></a>
            {% if ans['accepted']==1 %}
            <a class="action" href="{{ url_for('question.accept_answer', aid=ans['id'], qid=posts['qid']) }}"><i class="fas fa-check text-dark">Accepted</i></a>
            {% else %}
            <a class="action" href="{{ url_for('question.accept_answer', aid=ans['id'], qid=posts['qid']) }}"><i class="fas fa-check text-dark">Accept</i></a>
            {% endif %}
            </div>
            <div>
              <p style="text-align: right"><a class="action text-dark" href="{{ url_for('question.create_comment_ans', id=ans['id']) }}">Add comment </a></p>

              <br>
              {% if list1[ans['id']] | length ==0 %}
                 <!-- {%print "5" %}
                 {%print ans['id'] %} -->
              {% endif %}
                 {% for comm1 in list1[ans['id']] %}
                 <p style="text-align:right;margin-left:5%; font-style: italic;"><span >{{ comm1['body'] }}</span></p>
                {% endfor %}      
             <hr>
          </div>
          </div>
        </div>
      </header>
    </article>
    {% if not loop.last %}
      <hr>
    {% endif %}
  {% endfor %}
    <a class="action blog-post-meta" href="{{ url_for('question.createanswer', id=posts['qid']) }}"> Add Answer</a>
    {% endblock %}
    {% block footer %}
{{super()}}
{% endblock %}

